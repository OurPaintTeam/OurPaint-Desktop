# OurPaint

**Полное название приложения**:

Система автоматизированного проектирования на двумерной плоскости с использованием QT и возможностью совместной работы “OurPaint”

**Описание**
> [!IMPORTANT]
> **OurPaint** — это система автоматизированного проектирования (САПР) на двумерной плоскости, разработанная с использованием фреймворка Qt. Она позволяет пользователям создавать и редактировать геометрические примитивы, такие как линии, точки и окружности. Программа поддерживает возможность совместной работы, что делает её подходящей для командных проектов.
## Основные функции
- **Геометрические примитивы**: Создание и редактирование базовых фигур (отрезки, точки, окружности).
- **Ограничения**: Добавление различных ограничений между объектами (например, сделать линии параллельными или перпендикулярными, задать расстояния между объектами).
- **Вывод**: Сохранение рисунков в формате `.bmp`, экспорт проектов в виде наборов инструкций для дальнейшего редактирования, вывод изображения на экран.
- **Совместная работа**: Реализация серверно-клиентской модели для одновременной работы нескольких пользователей в реальном времени.
- **Отмена/Повтор**: Возможность отменять и повторять действия.

## Разработчики
В третьем семестре проект будут разрабатывать студенты 2-го курса Санкт-Петербургского Государственного Университета (СПбГУ), факультета Прикладной Математики — Процессов Управления (ПМ-ПУ), по программе Программирование и информационные технологии (ПиИТ):
- **Бычков Евгений**
- **Скворчевский Тимофей**
- **Осканов Ибрагим**

## Технологический стек
- **C++**: Основной язык программирования.
- **CSS**: Для стилизации пользовательского интерфейса.
- **STL**: Библиотека шаблонов для работы с данными и алгоритмами.
- **Qt**: Кроссплатформенный фреймворк для разработки программного обеспечения.
- **GTest**: Библиотека для модульного тестирования
- **Собственные библиотеки**:
    - [BMPFile](https://github.com/SashaErkhov/BMPfile): Для работы с файлами формата `.bmp`.
    - [UndoRedo](https://github.com/Ardrass2/UndoRedo): Управление функцией отмены/повтора действий.
    - [Containers](https://github.com/SashaErkhov/Containers): Устаревший самописный класс контейнеров (рекомендуется минимизировать его использование).
    - [MinimizerOptimizer](https://github.com/Ardrass2/MinimizerOptimizer): Библиотека реализующая функционал оптимизаторов и прочих математических вещей(матрицы, графы).
- **Система контроля версий**: Git для управления кодом и совместной работы.
- **CMake**: кроссплатформенная утилита для автоматической сборки программы из исходного кода

## Средства разработки
- **IDE**: Microsoft Visual Studio / CLion.
- **UI Design**: Qt Creator для разработки интерфейса, Figma для проектирования дизайна.
- **Контроль версий**: Git (размещение на GitHub)

## Системные требования
- **Операционная система**: Windows 7 или новее.
- **Компилятор**: Visual Studio (2017 год и новее) или MingW 8.1.
- **QT6**: Для сборки проекта потребуеться установить QT6(немного проблематично в России)
- **Eigen3**: Скачивается автоматически, при сборке cmake

## Функции проекта
- Создание объектов (отрезок, точка, окружность).
- Создание требований для объектов (сделать отрезки параллельными, перпендикулярными, задать расстояние между отрезками, задать расстояние между точкой и отрезком, задать расстояние между точкой и точкой, задать расстояние между окружностью и отрезком,точкой, и так далее (список приведен ниже).
- Сохранение изображение в BMPFile.
- Сохранение проекта в виде набора инструкций(для дальнейшего быстрого открытия проекта уже с готовыми примитивами).
- Отрисовка проекта на рабочей области (под рабочей областью понимаем виджет приложения, в котором будет происходить отрисовка)
- Динамическое расширение или масштабирования(в случае фиксированного размера окна) рабочей области, в зависимости от проекта.
- Работа с командами пользователя (для создания примитивов, добавления требований, получения информации об элементе)
- Создания сервера для совместной работы.
- Возможность подключаться к совместной сессии
- Создание объектов с помощью мыши
## Хранимые данные
- Хранение геометрических примитивов и ограничений с использованием уникальных идентификаторов и описательной информации.

## Интерфейс
- **Рабочая область**: Область для рисования проекта.
- **Командная строка**: Поле ввода команд.
- **Кнопки сервер/клиент**: Кнопки для создания сервера и подключения к нему.
- **Виджет создания примитивов**: Виджет с перечнем доступных примитивов.

## Задачи на семестр
**До середины ноября**:
- Функция addrequirement, отвечающая за добавления требований на объекты должна быть рабочей(попробовать реализовать алгоритм Левенберга — Марквардта, либо метод наименьших квадратов, так как алгоритм Ньютона-Гаусса ,вероятно, не подходит, ввиду невыполнения требований на количество переменных)
- Доработать функции сохранения информации о проекте:
    - Придумать формат для сохранения информации об объектах
    - Добавить функцию, которая бы умела считывать файл проекта и добавлять требования и примитивы из него.
- Переход от консольного приложения к приложению в окне, для чего потребуется:
    - разделить приложение на вычислительный движок и движок отрисовки
    - Разработать дизайн приложения
    - Создать интерфейс приложения
    - Скомпоновать вычислительный движок и QT-приложение
- Добавление возможности создавать сервер(для совместной работы). Для этого потребуется:
    - Подумать над тем, на чьей стороне/сторонах проект происходить вычисления.
    - Автоматическое открытие портов, чтобы была возможность присоединяться к сессии.
    - Подумать над тем, как будет отображаться информация для совместной работы (имеется ввиду отображение действий других пользователей)
- Добавление возможности подключаться к серверу.

## Структура проекта
- **Ветки на GitHub**:
    - `main`: Основная ветка релиза (требуется 3 одобрения pull request'ов).
    - `experimental-working-paint`: Основная ветка разработки (одобрения pull request не требуется).
    - Именные ветки для выполнения подзадач.
    - `with-new-function`: Основная ветка разработки после добавления внешней библиотеки (одобрения pull request не требуется).
- **Требования**:
    - ET_POINTSECTIONDIST - задание расстояния между точкой и отрезком.
    - ET_POINTONSECTION - зафиксировать точку на отрезке
    - ET_POINTPOINTDIST - задание расстояние между точками.
    - ET_POINTONPOINT - зафиксировать точку на точке
    - ET_SECTIONCIRCLEDIST - задание расстояния между отрезком и окружностью
    - ET_SECTIONONCIRCLE - делает отрезок касательной к окружности
    - ET_SECTIONSECTIONPARALLEL - задает свойство параллельности для двух отрезков
    - ET_SECTIONSECTIONPERPENDICULAR - делает два отрезка перпендикулярными
    - ET_SECTIONSECTIONANGEL - задает угол между отрезками
    - ET_POINTONCIRCLE - ставит точку на окружность

**Файлы проекта**:
### `/headers`

1. **`enums.h`** — перечисления, используемые в проекте.
2. **`objects.h`** — определения объектов, используемых в проекте.
3. **`paint.h`** — интерфейсы и логика. Основной класс нашего проекта.
4. **`requirements.h`** — классы требований.
5. **`Scaling.h`** — обработка масштабирования.

---

### `/headers/ClientServer`

1. **`Client.h`** — логика для клиента.
2. **`LocalScanner.h`** — сканер локальной сети.
3. **`PortCheckTask.h`** — проверка доступности порта.
4. **`Server.h`** — логика для сервера.

---

### `/headers/GUI`

1. **`CastomeConsole.h`** — кастомизированная консоль.
2. **`EmojiWidget.h`** — виджет для работы с эмодзи.
3. **`FrameOverlay.h`** — наложение рамки для интерфейса.
4. **`mainwindow.h`** — заголовочный файл главного окна приложения.
5. **`mainwindow.ui`** — описание пользовательского интерфейса главного окна.
6. **`RightClickFilter.h`** — фильтр для обработки кликов правой кнопкой мыши.
7. **`ui_mainwindow.h`** — сгенерированный файл интерфейса главного окна.

---

### `/headers/GUI/Windows`

1. **`CastomeIpListWindow.h`** — окно для отображения или управления списком IP-адресов.
2. **`CastomeWindowError.h`** — окно для отображения ошибок.
3. **`CastomeWindowSuccessful.h`** — окно для сообщений об успешных действиях.
4. **`CastomeWindowWarning.h`** — окно для предупреждений.
5. **`help.h`** — заголовочный файл окна помощи.
6. **`help.ui`** — описание пользовательского интерфейса окна помощи.
7. **`SaveDialog.h`** — диалоговое окно сохранения данных.
8. **`ui_help.h`** — сгенерированный файл интерфейса окна помощи.
9. **`WindowServer.h`** — окно при создании сервера.

---

### `/headers/painters`

1. **`BMPpainter.h`** — работа с изображениями в формате BMP.
2. **`Painter.h`** — общий интерфейс для рисования.
3. **`QTPainter.h`** — логика рисования с использованием Qt.

---

### `/headers/saveload`

1. **`FileOurP.h`** — работа с данными проекта.
2. **`LoadSettingsApplications.h`** — загрузка настроек приложения.
3. **`objectInFile.h`** — логика работы с объектами, сохраненными в файле.
4. **`requirementInFile.h`** — работа с требованиями, сохраненными в файле.
5. **`rules.md`** — документ с правилами сохранения.
6. **`SaveSettingsApplications.h`** — сохранение настроек приложения.

### `/src/`

Здесь есть реализация для классов из заголовков

### `/math/`

Подмодуль MinimizerOptimizer, хранящий в себе оптимизаторы, матрицы и графы

### `/BMPFile/`

Подмодуль BMPFile отвечает за возможность создания/редактирования/сохранения BMP файлов

### `/additions/`

Подмодуль с собственной реализацией некоторых STL классов

### `/Static/`

Папка с хранящимися в ней иконками

## Руководство для разработчиков

### Требования к окружению
Для успешной сборки и запуска проекта необходимо установить следующие инструменты и библиотеки:

1. **Qt 6 (Qt GUI, Qt Widgets)**
  - Для создания пользовательского интерфейса.
  - Скачивание: [Qt Download](https://www.qt.io/download-qt-installer)

2. **CMake**
  - Используется для сборки проекта.
  - Скачивание: [CMake Download](https://cmake.org/download/)

3. **Компиляторы** (выбор на ваше усмотрение):
  - **MinGW** (Windows через MinGW):
    - Скачивание: [MinGW-W64](https://mingw-w64.org/)
  - **MSVC** (Microsoft Visual Studio):
    - Скачивание: [Visual Studio](https://visualstudio.microsoft.com/)
  - **Clang** (опционально, если требуется):
    - Скачивание: [LLVM Project](https://llvm.org/)

4. **Eigen 3**
  - Линейная алгебра.
  - Скачивание: [Eigen](https://eigen.tuxfamily.org/)
### Настройка.
1. Скачайте компилятор для вашей среды разработке
2. После установки, установите QT6. **ОБЯЗАТЕЛЬНО**, в меню с выбором компонентов, выберите используемый вами компилятор
3. Добавьте папку `Qt\ваша_версия\bin\название_компилятора\bin` в переменную среды PATH
4. Установите cmake
5. Склонируйте проект с репозитория и перейдите в ветку разработки(`with_new_function`)
6. Загрузите подмодули(
   - `git submodule init`
   - `git submodule update`

   )
7. Запустите вашу среду разработке, скомпилируйте проект, используя cmake и ваш компилятор.

**В случае невозможности скачивания Eigen с помощью `FetchContent` загрузите его вручную**
TODO для команды *my-paint*:
 - продумать логгирование
 - реализовать возможность открытия глобальных портов(если получиться) для подключения из вне
